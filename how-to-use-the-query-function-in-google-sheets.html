<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="SwiftBlog"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="How to Use the QUERY Function in Google Sheets"><meta property="og:title" content="How to Use the QUERY Function in Google Sheets"><meta property="twitter:title" content="How to Use the QUERY Function in Google Sheets"><meta name=description content="If you need to manipulate data in Google Sheets, the QUERY function can help! It brings powerful, database-style searching to your spreadsheet, so you can look up and filter your data in any format you like. We'll walk you through how to use it."><meta property="og:description" content="If you need to manipulate data in Google Sheets, the QUERY function can help! It brings powerful, database-style searching to your spreadsheet, so you can look up and filter your data in any format you like. We'll walk you through how to use it."><meta property="twitter:description" content="If you need to manipulate data in Google Sheets, the QUERY function can help! It brings powerful, database-style searching to your spreadsheet, so you can look up and filter your data in any format you like. We'll walk you through how to use it."><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>How to Use the QUERY Function in Google Sheets |</title><link rel=canonical href=./how-to-use-the-query-function-in-google-sheets.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>SwiftBlog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>How to Use the QUERY Function in Google Sheets</h1><h2 class=subheading></h2><span class=meta>Posted by
Reinaldo Massengill
on
Friday, August 16, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h3 class="title icon i-flash">Quick Links</h3><ul class=table-content-list><li class="table-content-element icon"><a href=#>Using the QUERY Function</a></li></ul><ul class=table-content-list><li class="table-content-element icon"><a href=#>Advanced QUERY Formulas</a></li></ul><p>If you need to manipulate data in Google Sheets, the QUERY function can help! It brings powerful, database-style searching to your spreadsheet, so you can look up and filter your data in any format you like. We'll walk you through how to use it.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=using-the-query-function>Using the QUERY Function</h2><p>The QUERY function isn't too difficult to master if you've ever interacted with a database using SQL. The format of a typical QUERY function is similar to SQL and brings the power of database searches to Google Sheets.</p><p>The format of a formula that uses the QUERY function is</p><pre><code class=hljs>=QUERY(data, query, headers)</code> </pre><p>. You replace "data" with your cell range (for example, "A2:D12" or "A:D"), and "query" with your search query.</p><p>The optional "headers" argument sets the number of header rows to include at the top of your data range. If you have a header that spreads over two cells, like "First" in A1 and "Name" in A2, this would specify that QUERY use the contents of the first two rows as the combined header.</p><p>In the example below, a sheet (called "Staff List") of a Google Sheets spreadsheet includes a list of employees. It includes their names, employee ID numbers, birth dates, and whether they've attended their mandatory employee training session.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2019/12/Sheets-QUERY-Data.png><p>On a second sheet, you can use a QUERY formula to pull a list of all of employees who haven't attended the mandatory training session. This list will include employee ID numbers, first names, last names, and whether they attended the training session.</p><p>To do this with the data shown above, you could type</p><pre><code class="hljs sql">=QUERY('Staff List'!A2:E12, "<span class=hljs-keyword>SELECT</span> A, B, C, E <span class=hljs-keyword>WHERE</span> E = <span class=hljs-string>'No'</span><span class=hljs-string>")</span></code> </pre><p>. This queries the data from range A2 to E12 on the "Staff List" sheet.</p><p>Like a typical SQL query, the QUERY function selects the columns to display (SELECT) and identifies the parameters for the search (WHERE). It returns columns A, B, C, and E, providing a list of all matching rows in which the value in column E ("Attended Training") is a text string containing "No."</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2019/12/Sheets-QUERY-Data.png><p>As shown above, four employees from the initial list haven't attended a training session. The QUERY function provided this info, as well as matching columns to show their names and employee ID numbers in a separate list.</p><p>This example uses a very specific range of data. You could change this to query all the data in columns A to E. This would allow you to continue to add new employees to the list. The QUERY formula you used will also update automatically whenever you add new employees or when someone attends the training session.</p><p>The correct formula for this is&nbsp;</p><pre><code class="hljs sql">=QUERY('Staff List'!A2:E, "<span class=hljs-keyword>Select</span> A, B, C, E <span class=hljs-keyword>WHERE</span> E = <span class=hljs-string>'No'</span><span class=hljs-string>")</span></code> </pre><p>. This formula ignores the initial "Employees" title in cell A1.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>If you add an 11th employee who hasn't attended the training to the initial list, as shown below (Christine Smith), the QUERY formula updates, as well, and displays the new employee.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2019/12/Sheets-QUERY-Data.png><h2 id=advanced-query-formulas>Advanced QUERY Formulas</h2><p>The QUERY function is versatile. It allows you to use other logical operations (like AND and OR) or Google functions (like COUNT) as part of your search. You can also use comparison operators (greater than, less than, and so on) to find values between two figures.</p><h3 id=using-comparison-operators-with-query>Using Comparison Operators with QUERY</h3><p>You can use QUERY with comparison operators (like less than, greater than, or equal to) to narrow down and filter data. To do this, we'll add an additional column (F) to our "Staff List" sheet with the number of awards each employee has won.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Using QUERY, we can search for all employees who have won at least one award. The format for this formula is&nbsp;</p><pre><code class="hljs sql">=QUERY(<span class=hljs-string>'Staff List'</span>!A2:F12, <span class=hljs-string>"SELECT A, B, C, D, E, F WHERE F &gt; 0"</span>)</code> </pre><p>.</p><p>This uses a greater than comparison operator (>) to search for values above zero in column F.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2019/12/Sheets-QUERY-with-OR-Edit.png><p>The example above shows the QUERY function returned a list of eight employees who have won one or more awards. Out of 11 total employees, three have never won an award.</p><h3 id=using-and-and-or-with-query>Using AND and OR with QUERY</h3><p>Nested <a href=#>logical operator functions like AND and OR</a>&nbsp;work well within a larger QUERY formula to add multiple search criteria to your formula.</p><p><span class=related-single>Related: <a href=#>How to Use the AND and OR Functions in Google Sheets</a></span></p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>A good way to test AND is to search for data between two dates. If we use our employee list example, we could list all employees born from 1980 to 1989.</p><p>This also takes advantage of comparison operators, like greater than or equal to (>=) and less than or equal to (&lt;=).</p><p>The format for this formula is&nbsp;</p><pre><code class="hljs sql">=QUERY('Staff List'!A2:E12, "<span class=hljs-keyword>SELECT</span> A, B, C, D, E <span class=hljs-keyword>WHERE</span> D &gt;= <span class=hljs-built_in>DATE</span>&nbsp;<span class=hljs-string>'1980-1-1'</span>&nbsp;<span class=hljs-keyword>and</span> D &lt;= <span class=hljs-built_in>DATE</span>&nbsp;<span class=hljs-string>'1989-12-31'</span><span class=hljs-string>")</span></code> </pre><p>. This also uses an additional nested DATE function to parse date timestamps correctly, and looks for all birthdays between and equal to January 1, 1980, and December 31, 1989.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2019/12/Sheets-QUERY-with-COUNT.png><p>As shown above, three employees who were born in 1980, 1986, and 1983 meet these requirements.</p><p>You can also use OR to produce similar results. If we use the same data, but switch the dates and use OR, we can exclude all employees who were born in the 1980s.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The format for this formula would be&nbsp;</p><pre><code class="hljs sql">=QUERY('Staff List'!A2:E12, "<span class=hljs-keyword>SELECT</span> A, B, C, D, E <span class=hljs-keyword>WHERE</span> D &gt;= <span class=hljs-built_in>DATE</span>&nbsp;<span class=hljs-string>'1989-12-31'</span>&nbsp;<span class=hljs-keyword>or</span> D &lt;= <span class=hljs-built_in>DATE</span>&nbsp;<span class=hljs-string>'1980-1-1'</span><span class=hljs-string>")</span></code> </pre><p>.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src><p>Of the original 10 employees, three were born in the 1980s. The example above shows the remaining seven, who were all born before or after the dates we excluded.</p><h3 id=using-count-with-query>Using COUNT with QUERY</h3><p>Rather than simply searching for and returning data, you can also mix QUERY with other functions, like COUNT, to manipulate data. Let's say we want to clear a number of all the employees on our list who have and haven't attended the mandatory training session.</p><p>To do this, you can combine QUERY with COUNT like this&nbsp;&nbsp;</p><pre><code class="hljs sql">=QUERY('Staff List'!A2:E12, "<span class=hljs-keyword>SELECT</span> E, <span class=hljs-keyword>COUNT</span>(E) <span class=hljs-keyword>group</span>&nbsp;<span class=hljs-keyword>by</span> E<span class=hljs-string>")</span></code> </pre><p>.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Focusing on column E ("Attended Training"), the QUERY function used COUNT to count the number of times each type of value (a "Yes" or a "No" text string) was found. From our list, six employees have completed the training, and four haven't.</p><p>You can easily change this formula and use it with other types of Google functions, like SUM.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGhrbmhka4JwtM6wZK2nXarApnnToZxmqaWav7p5xa6lnKyZpLtutc1mnqinl6Gybr%2FHnpytq18%3D</p><hr><ul class=pager><li class=previous><a href=./jujutsu-kaisen-chapter-240-spoilers-release-time-and-where-to-read.html data-toggle=tooltip data-placement=top title="Jujutsu Kaisen chapter 240 spoilers, release time, and where to read">&larr;
Previous Post</a></li><li class=next><a href=./baldurs-gate-3-gets-54-new-playable-races-with-this-mod.html data-toggle=tooltip data-placement=top title="Baldur's Gate 3 Gets 54 New Playable Races With This Mod">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; SwiftBlog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>